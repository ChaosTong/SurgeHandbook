# DNS

为了支持高级特性，Surge 使用自己的自定义 DNS 服务器。所以可能跟你在系统里设置的效果不太一样。

## 上游 DNS 服务器

默认情况下，Surge 会使用系统设置里的 DNS 服务器。你可以通过 dns-server 这个选项来覆盖系统设置。

## 细节信息

Surge 通过并发查询提高性能，会使用返回结果最快的服务器，这类似于 dnsmasq 命令的 --all-servers 选项。Surge iOS 版和 macOS 版的 Dashboard 会显示返回结果最快的那个服务器地址。如果 Surge 在 2 秒内没有收到任何响应，它将再次查询所有预设的 DNS 服务器。重试 4 次后如果还没有结果，Surge 将放弃查询并报告 DNS 错误。 某些域名可能具有性能较差的权限域名服务器，导致上游 DNS 服务器由于服务器端超时或其他连接问题返回空结果。如果**所有**上游 DNS 服务器确实都返回空的 DNS 查询结果，或者某些服务器返回空的结果，但其他服务器在 2 秒内没有响应，那 Surge 也将返回 DNS 查询结果为空的错误。 当 IPv6 可用并启用时，Surge DNS 客户端将向上游 DNS 服务器同时发送 A 和 AAAA 查询。将使用返回的第一个 A 或 AAAA 查询结果。

